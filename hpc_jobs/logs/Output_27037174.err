Traceback (most recent call last):
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 856, in next
Process ForkPoolWorker-32:
Process ForkPoolWorker-57:
Process ForkPoolWorker-28:
Process ForkPoolWorker-20:
Process ForkPoolWorker-62:
Process ForkPoolWorker-49:
Process ForkPoolWorker-60:
Process ForkPoolWorker-47:
Process ForkPoolWorker-10:
Process ForkPoolWorker-41:
Process ForkPoolWorker-40:
Process ForkPoolWorker-21:
Process ForkPoolWorker-54:
Process ForkPoolWorker-30:
Process ForkPoolWorker-13:
Process ForkPoolWorker-58:
Process ForkPoolWorker-55:
Process ForkPoolWorker-17:
Process ForkPoolWorker-56:
Process ForkPoolWorker-35:
    item = self._items.popleft()
           ^^^^^^^^^^^^^^^^^^^^^
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 119, in reduce
Process ForkPoolWorker-37:
Process ForkPoolWorker-31:
Process ForkPoolWorker-9:
Process ForkPoolWorker-26:
Process ForkPoolWorker-46:
Process ForkPoolWorker-29:
Process ForkPoolWorker-16:
Process ForkPoolWorker-7:
Process ForkPoolWorker-38:
Process ForkPoolWorker-51:
Process ForkPoolWorker-1:
Process ForkPoolWorker-42:
Process ForkPoolWorker-8:
Process ForkPoolWorker-50:
Process ForkPoolWorker-23:
Process ForkPoolWorker-52:
Process ForkPoolWorker-36:
Process ForkPoolWorker-3:
Process ForkPoolWorker-59:
Process ForkPoolWorker-45:
Process ForkPoolWorker-48:
    for i, result in enumerate(pool.imap_unordered(process_single_mmsi, mmsi_tasks, chunksize=chunk_size), 1):
Process ForkPoolWorker-24:
Process ForkPoolWorker-22:
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 451, in <genexpr>
Process ForkPoolWorker-44:
    return (item for chunk in result for item in chunk)
Process ForkPoolWorker-63:
Process ForkPoolWorker-15:
Process ForkPoolWorker-61:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 861, in next
Process ForkPoolWorker-25:
    self._cond.wait(timeout)
Process ForkPoolWorker-39:
  File "/appl9/python/3.11.9/lib/python3.11/threading.py", line 327, in wait
Process ForkPoolWorker-18:
Process ForkPoolWorker-27:
Process ForkPoolWorker-19:
Process ForkPoolWorker-4:
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 185, in <module>
Process ForkPoolWorker-6:
    reduce(final_dir=args.output_dir, temp_dir=temp_dir, n_workers=num_workers, logger=logger)
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 118, in reduce
Process ForkPoolWorker-33:
Process ForkPoolWorker-34:
Process ForkPoolWorker-43:
    with Pool(processes=n_workers, maxtasksperchild=max(1,1000//chunk_size)) as pool:
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 739, in __exit__
Process ForkPoolWorker-5:
Process ForkPoolWorker-12:
Process ForkPoolWorker-53:
    self.terminate()
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 657, in terminate
Process ForkPoolWorker-11:
    self._terminate()
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/util.py", line 227, in __call__
    res = self._callback(*self._args, **self._kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 690, in _terminate_pool
    change_notifier.put(None)
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/queues.py", line 371, in put
Traceback (most recent call last):
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 69, in process_single_mmsi
    processed_data, preprocessing_results = preprocess_mmsi_track(full_track)
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/preprocessing.py", line 31, in preprocess_mmsi_track
    lon_idx = np.logical_or((track_data[:,LON] > LON_MAX),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
    ^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/reduction.py", line 39, in __init__
    super().__init__(*args)
KeyboardInterrupt
