wandb: Currently logged in as: bertram-hage (bertram-hage-danmarks-tekniske-universitet-dtu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run 627nbnwr
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /zhome/ea/6/187439/computational-tools-project/wandb/run-20251115_140735-627nbnwr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pipeline_2024_map_reduce
wandb: ‚≠êÔ∏è View project at https://wandb.ai/bertram-hage-danmarks-tekniske-universitet-dtu/Computational-Tools
wandb: üöÄ View run at https://wandb.ai/bertram-hage-danmarks-tekniske-universitet-dtu/Computational-Tools/runs/627nbnwr
wandb: WARNING `start_method` is deprecated and will be removed in a future version of wandb. This setting is currently non-functional and safely ignored.
Traceback (most recent call last):
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 856, in next
    item = self._items.popleft()
           ^^^^^^^^^^^^^^^^^^^^^
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 145, in reduce
    for i, result in enumerate(pool.imap_unordered(process_single_mmsi, mmsi_tasks, chunksize=chunk_size), 1):
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 451, in <genexpr>
    return (item for chunk in result for item in chunk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 861, in next
    self._cond.wait(timeout)
  File "/appl9/python/3.11.9/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 227, in <module>
    reduce(final_dir=args.output_dir, temp_dir=temp_dir, n_workers=num_workers, logger=logger)
  File "/zhome/ea/6/187439/computational-tools-project/src/preprocessing/map_reduce.py", line 144, in reduce
    with Pool(processes=n_workers, maxtasksperchild=max(1,1000//chunk_size)) as pool:
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 739, in __exit__
    self.terminate()
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/pool.py", line 657, in terminate
    self._terminate()
  File "/appl9/python/3.11.9/lib/python3.11/multiprocessing/util.py", line 221, in __call__
    if self._pid != getpid():
                    ^^^^^^^^
KeyboardInterrupt
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f9ca9835260>
Traceback (most recent call last):
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_connection.py", line 61, in teardown_atexit
socket.send() raised exception.
socket.send() raised exception.
    conn.teardown(hooks.exit_code)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_connection.py", line 236, in teardown
    self._asyncer.run(publish_teardown_and_close)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 136, in run
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
socket.send() raised exception.
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
socket.send() raised exception.
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
socket.send() raised exception.
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
socket.send() raised exception.
socket.send() raised exception.
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
socket.send() raised exception.
socket.send() raised exception.
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
socket.send() raised exception.
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
socket.send() raised exception.
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
socket.send() raised exception.
socket.send() raised exception.
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
socket.send() raised exception.
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
socket.send() raised exception.
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
socket.send() raised exception.
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
socket.send() raised exception.
socket.send() raised exception.
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
socket.send() raised exception.
socket.send() raised exception.
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/asyncio_manager.py", line 181, in fn_wrap_exceptions
    await fn()
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 38, in publish
    await self._send_server_request(request)
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 64, in _send_server_request
socket.send() raised exception.
socket.send() raised exception.
    await self._writer.drain()
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 380, in drain
    raise exc
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 73, in _forward_responses
socket.send() raised exception.
socket.send() raised exception.
    while response := await self._read_server_response():
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/zhome/ea/6/187439/computational-tools-project/.venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_client.py", line 87, in _read_server_response
    header = await self._reader.readexactly(_HEADER_BYTE_INT_LEN)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 750, in readexactly
socket.send() raised exception.
socket.send() raised exception.
    await self._wait_for_data('readexactly')
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/streams.py", line 543, in _wait_for_data
    await self._waiter
  File "/appl9/python/3.11.9/lib/python3.11/asyncio/selector_events.py", line 1061, in write
socket.send() raised exception.
socket.send() raised exception.
    n = self._sock.send(data)
        ^^^^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe
Process ForkPoolWorker-5:
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
socket.send() raised exception.
